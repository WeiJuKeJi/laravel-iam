{
  "openapi": "3.0.3",
  "info": {
    "title": "认证管理 API",
    "description": "用户认证相关接口，包括登录、登出和获取用户信息",
    "version": "1.0.0"
  },
  "paths": {
    "/iam/auth/login": {
      "post": {
        "tags": ["Iam/Auth"],
        "summary": "用户登录",
        "description": "使用账号密码登录系统，账号可以是用户名或邮箱\n\n**测试用例：**\n1. 使用用户名登录\n2. 使用邮箱登录",
        "operationId": "login",
        "parameters": [
          { "name": "Accept", "in": "header", "required": true, "schema": { "type": "string" }, "example": "application/json" }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "examples": {
                "用户名登录": {
                  "summary": "使用用户名登录",
                  "value": { "account": "admin", "password": "password123" }
                },
                "邮箱登录": {
                  "summary": "使用邮箱登录",
                  "value": { "account": "admin@example.com", "password": "password123" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "登录成功",
            "content": {
              "application/json": {
                "example": { "code": 200, "msg": "登录成功", "data": { "token": "1|abcdefghijklmnopqrstuvwxyz1234567890", "token_type": "Bearer", "expires_in": 3600, "user": { "id": 1, "name": "管理员", "username": "admin", "email": "admin@example.com" } } }
              }
            }
          },
          "401": {
            "description": "认证失败",
            "content": {
              "application/json": {
                "example": { "code": 401, "msg": "账号或密码错误", "data": null }
              }
            }
          },
          "422": { "$ref": "#/components/responses/ValidationError" }
        }
      }
    },
    "/iam/auth/logout": {
      "post": {
        "tags": ["Iam/Auth"],
        "summary": "用户登出",
        "description": "退出登录，撤销当前访问令牌",
        "operationId": "logout",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "Accept", "in": "header", "required": true, "schema": { "type": "string" }, "example": "application/json" }
        ],
        "responses": {
          "200": {
            "description": "登出成功",
            "content": {
              "application/json": {
                "example": { "code": 200, "msg": "退出成功", "data": null }
              }
            }
          },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/iam/auth/me": {
      "get": {
        "tags": ["Iam/Auth"],
        "summary": "获取当前用户信息",
        "description": "获取当前登录用户的详细信息，包括角色和权限",
        "operationId": "me",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "Accept", "in": "header", "required": true, "schema": { "type": "string" }, "example": "application/json" }
        ],
        "responses": {
          "200": {
            "description": "成功",
            "content": {
              "application/json": {
                "example": { "code": 200, "msg": "success", "data": { "id": 1, "name": "管理员", "username": "admin", "email": "admin@example.com", "status": "active", "roles": [{ "id": 1, "name": "super-admin", "display_name": "超级管理员" }], "permissions": ["*"] } }
              }
            }
          },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "Token"
      }
    },
    "responses": {
      "Unauthorized": {
        "description": "未授权",
        "content": {
          "application/json": {
            "example": { "code": 401, "msg": "未授权访问", "data": null }
          }
        }
      },
      "ValidationError": {
        "description": "数据校验失败",
        "content": {
          "application/json": {
            "example": { "code": 422, "msg": "数据校验失败", "data": { "errors": { "account": ["登录账号不能为空"], "password": ["密码长度至少6位"] } } }
          }
        }
      }
    }
  }
}
